# 技術ドキュメント一括Markdown化ツール 開発プラン

## プロジェクト概要
Web上の技術ドキュメントサイトのコンテンツを、サイトの階層構造を維持したまま一括でMarkdownファイルに変換・保存するコマンドラインツールの開発。

## 開発フェーズ

### フェーズ1: プロジェクトセットアップと依存関係
1. **プロジェクト構造の作成**
   - `main.py` - メインエントリーポイントと全体調整
   - `crawler.py` - Webクローリングとリンク発見
   - `converter.py` - HTMLからMarkdownへの変換
   - `config.yaml` - 設定テンプレート
   - `requirements.txt` - Python依存関係
   - `README.md` - 使用方法説明

2. **requirements.txtでの依存関係セットアップ**
   - `requests` - HTTPリクエスト
   - `beautifulsoup4` - HTML解析
   - `lxml` - 高速XML/HTMLパーサー
   - `pyyaml` - YAML設定解析
   - `html2text` - HTMLからMarkdownへの変換

### フェーズ2: 設定管理
3. **設定ハンドラーの作成**
   - `config.yaml`の読み込みと検証
   - デフォルト値の提供
   - 設定エラーの適切な処理

4. **サンプル設定の作成**
   - 仕様に基づいたPythonドキュメントを例とした設定

### フェーズ3: Webクローラー実装
5. **クローラークラスの実装**
   - URLキューの管理
   - 重複URL検出
   - ドメインとパターンフィルタリング
   - ナビゲーションセレクターベースのリンク発見
   - リクエスト制限
   - HTTP失敗のエラーハンドリング

### フェーズ4: コンテンツ変換
6. **HTMLからMarkdown変換器の実装**
   - CSSセレクターを使用したコンテンツ抽出
   - 適切なフォーマットでのHTMLからMarkdown変換
   - コードブロック言語の保持
   - 画像処理（ダウンロード vs URL保持）
   - ローカルファイル用のリンクURL調整

### フェーズ5: ファイルシステム操作
7. **ファイル管理の実装**
   - URLパスに基づいたディレクトリ構造の作成
   - 特殊ケースの処理（`index.html` → `README.md`）
   - 適切なエンコーディングでのMarkdownファイル保存
   - 画像のダウンロードと整理

### フェーズ6: メインアプリケーションロジック
8. **メイン調整機能の作成**
   - 全コンポーネントの初期化
   - クローリングプロセスの管理
   - 進捗レポートの提供
   - 適切なシャットダウン

### フェーズ7: エラーハンドリングとロギング
9. **包括的エラーハンドリングの追加**
   - ネットワーク失敗
   - コンテンツ抽出失敗
   - ファイルシステムエラー
   - 設定エラー

10. **進捗ログの実装**
    - フォーマット: `[現在/総数] 処理中: (URL)`

### フェーズ8: テストとドキュメント
11. **一般的なドキュメントサイト用の設定例作成**
12. **使用方法説明と例の追加**

## 技術仕様
- **言語**: Python 3.9以上
- **主要ライブラリ**: requests, beautifulsoup4, lxml, pyyaml, html2text
- **設定駆動**: `config.yaml`による完全な動作制御
- **エラー耐性**: 個別ページの失敗でも処理続行

## 実行方法
```bash
pip install -r requirements.txt
python main.py
```

このプランにより、様々なドキュメントサイトに対応できる堅牢で設定駆動のツールを作成し、構造を保持しながら読みやすいMarkdown形式に変換します。